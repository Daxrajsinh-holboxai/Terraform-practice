### Documentation Referred:

https://registry.terraform.io/
https://registry.terraform.io/providers/hashicorp/aws/latest/docs
https://developer.hashicorp.com/terraform/language/resources/provisioners/local-exec
https://developer.hashicorp.com/terraform/language/resources/provisioners/remote-exec

### File layout (architecture)

- **variables.tf** – Variable declarations (types, descriptions). No secrets here.
- **terraform.tfvars.example** – Example values. Copy to `terraform.tfvars` and fill in; `terraform.tfvars` is auto-loaded and is in `.gitignore`.
- **local_remote_exec.tf** – Provider, data sources, and resources (EC2, provisioners, etc.).

### local_remote_exec.tf

This demo shows:

1. **local-exec** – Runs on your machine after the EC2 instance is created. It writes the instance’s public IP to `ec2_ip.txt`.
2. **remote-exec** – Runs on the EC2 instance over SSH. It writes `Working` to `/tmp/remote_exec_demo.txt` and prints it.

**Variables (declared in variables.tf; values in terraform.tfvars):**

- `aws_region` – AWS region
- `aws_access_key` – AWS access key (sensitive)
- `aws_secret_key` – AWS secret key (sensitive)
- `instance_type` – EC2 instance type (default: `t2.micro`)
- `ami_id` – AMI ID for the instance (region-specific)
- `environment` – Environment label for tags (default: `demo`)

**Resources:**

- Default VPC and subnet (for public IP)
- TLS private key and AWS key pair (for SSH)
- Security group allowing SSH (port 22)
- EC2 instance with:
  - **local-exec** provisioner → writes public IP to `ec2_ip.txt`
  - **remote-exec** provisioner → runs `echo 'Working' > /tmp/remote_exec_demo.txt` and `cat` on the instance

**Outputs:**

- `instance_public_ip` – Public IP of the demo instance
- `ec2_ip_file` – Path to the local `ec2_ip.txt` file
- `remote_task_file` – Path on EC2: `/tmp/remote_exec_demo.txt`

### Commands:

```sh
# Copy example tfvars and set your values (terraform.tfvars is not committed)
cp terraform.tfvars.example terraform.tfvars
# Edit terraform.tfvars with aws_access_key, aws_secret_key, etc.

terraform init
terraform plan
terraform apply
```

After apply:

- Check `ec2_ip.txt` in this folder for the EC2 public IP.
- To confirm remote-exec on the instance:
  ```sh
  ssh -i demo_key.pem ec2-user@<PUBLIC_IP> "cat /tmp/remote_exec_demo.txt"
  ```
  You should see: `Working`

### Notes:

- Variables are declared in **variables.tf** and values set in **terraform.tfvars** (copy from `terraform.tfvars.example`). `terraform.tfvars` is in `.gitignore` so credentials are not committed.
- `demo_key.pem` is generated by Terraform; keep it private and do not commit it.
- `ec2_ip.txt` is generated by local-exec and is listed in `.gitignore`.
